
R version 4.4.2 (2024-10-31 ucrt) -- "Pile of Leaves"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(distfreereg)
> set.seed(20240123)
> n <- 1e2
> func <- function(x, theta) theta[1]*x[1] + theta[2]*x[2] + theta[3]*x[3]
> Sig <- rWishart(1, df = n, Sigma = diag(n))[,,1]
> theta <- c(5, 1, -3)
> X <- cbind(1, matrix(replicate(2, sample(1:10, size = n, replace = TRUE)), ncol = 2))
> colnames(X) <- c("a", "b", "c")
> Y <- distfreereg:::f2ftheta(f = func, X)(theta) +
+   as.vector(distfreereg:::rmvnorm(n = n, reps = 1, mean = rep(0,n), SqrtSigma = distfreereg:::matsqrt(Sig)))
> 
> dfr_1 <- distfreereg(Y = Y, X = X, test_mean = func, covariance = list(Sigma = Sig),
+                      theta_init = c(1,1,1), verbose = TRUE, ordering = "asis")
Calculating the inverse square root of the covariance matrix...
Estimating parameters...
Calculating fitted values...
Calculating Jacobian...
Using supplied inverse square root of the covariance matrix...
Calculating mu...
Leaving observation order as is...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
Warning messages:
1: In validate_args_distfreereg_function(Y = Y, X = X, test_mean = test_mean,  :
  At least one column of X contains only one value. Verify that the model is identifiable.
2: In validate_args_distfreereg_default(Y = Y, X = X, covariance = covariance,  :
  At least one column of X contains only one value. Verify that the model is identifiable.
> dfr_2 <- distfreereg(Y = Y, X = X, test_mean = func, covariance = list(Sigma = Sig),
+                      theta_init = c(1,1,1), verbose = TRUE, ordering = "optimal")
Calculating the inverse square root of the covariance matrix...
Estimating parameters...
Calculating fitted values...
Calculating Jacobian...
Using supplied inverse square root of the covariance matrix...
Calculating mu...
Ordering observations using optimal transport...
- Creating distance matrix...
- Solving linear sum assignment problem using the Hungarian method...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
Warning messages:
1: In validate_args_distfreereg_function(Y = Y, X = X, test_mean = test_mean,  :
  At least one column of X contains only one value. Verify that the model is identifiable.
2: In validate_args_distfreereg_default(Y = Y, X = X, covariance = covariance,  :
  At least one column of X contains only one value. Verify that the model is identifiable.
> dfr_3 <- distfreereg(Y = Y, X = X, test_mean = func, covariance = list(Sigma = Sig),
+                      theta_init = c(1,1,1), verbose = TRUE, ordering = "simplex")
Calculating the inverse square root of the covariance matrix...
Estimating parameters...
Calculating fitted values...
Calculating Jacobian...
Using supplied inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by simplex method...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
Warning messages:
1: In validate_args_distfreereg_function(Y = Y, X = X, test_mean = test_mean,  :
  At least one column of X contains only one value. Verify that the model is identifiable.
2: In validate_args_distfreereg_default(Y = Y, X = X, covariance = covariance,  :
  At least one column of X contains only one value. Verify that the model is identifiable.
> dfr_4 <- distfreereg(Y = Y, X = X, test_mean = func, covariance = list(Sigma = Sig),
+                      theta_init = c(1,1,1), verbose = TRUE, ordering = "natural")
Calculating the inverse square root of the covariance matrix...
Estimating parameters...
Calculating fitted values...
Calculating Jacobian...
Using supplied inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by natural order...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
Warning messages:
1: In validate_args_distfreereg_function(Y = Y, X = X, test_mean = test_mean,  :
  At least one column of X contains only one value. Verify that the model is identifiable.
2: In validate_args_distfreereg_default(Y = Y, X = X, covariance = covariance,  :
  At least one column of X contains only one value. Verify that the model is identifiable.
> dfr_5 <- distfreereg(Y = Y, X = X, test_mean = func, covariance = list(Sigma = Sig),
+                      theta_init = c(1,1,1), verbose = TRUE, ordering = list(1:ncol(X)))
Calculating the inverse square root of the covariance matrix...
Estimating parameters...
Calculating fitted values...
Calculating Jacobian...
Using supplied inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by specified columns...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
Warning messages:
1: In validate_args_distfreereg_function(Y = Y, X = X, test_mean = test_mean,  :
  At least one column of X contains only one value. Verify that the model is identifiable.
2: In validate_args_distfreereg_default(Y = Y, X = X, covariance = covariance,  :
  At least one column of X contains only one value. Verify that the model is identifiable.
> dfr_6 <- distfreereg(Y = Y, X = X, test_mean = func, covariance = list(Sigma = Sig),
+                      theta_init = c(1,1,1), verbose = TRUE, ordering = list("b", "c"))
Calculating the inverse square root of the covariance matrix...
Estimating parameters...
Calculating fitted values...
Calculating Jacobian...
Using supplied inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by specified columns...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
Warning messages:
1: In validate_args_distfreereg_function(Y = Y, X = X, test_mean = test_mean,  :
  At least one column of X contains only one value. Verify that the model is identifiable.
2: In validate_args_distfreereg_default(Y = Y, X = X, covariance = covariance,  :
  At least one column of X contains only one value. Verify that the model is identifiable.
> 
> dfr_1[["res_order"]]
  [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18
 [19]  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36
 [37]  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54
 [55]  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72
 [73]  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90
 [91]  91  92  93  94  95  96  97  98  99 100
> dfr_2[["res_order"]]
Optimal assignment:
1 => 46, 2 => 78, 3 => 17, 4 => 49, 5 => 4, 6 => 47, 7 => 67, 8 => 10,
9 => 1, 10 => 74, 11 => 15, 12 => 94, 13 => 99, 14 => 91, 15 => 43,
16 => 26, 17 => 54, 18 => 64, 19 => 71, 20 => 9, 21 => 98, 22 => 65,
23 => 68, 24 => 76, 25 => 69, 26 => 31, 27 => 88, 28 => 27, 29 => 13,
30 => 30, 31 => 81, 32 => 52, 33 => 56, 34 => 34, 35 => 35, 36 => 39,
37 => 92, 38 => 60, 39 => 51, 40 => 29, 41 => 25, 42 => 18, 43 => 32,
44 => 97, 45 => 85, 46 => 3, 47 => 48, 48 => 19, 49 => 7, 50 => 50,
51 => 84, 52 => 89, 53 => 36, 54 => 38, 55 => 28, 56 => 41, 57 => 55,
58 => 11, 59 => 23, 60 => 70, 61 => 75, 62 => 8, 63 => 72, 64 => 86,
65 => 22, 66 => 24, 67 => 44, 68 => 59, 69 => 73, 70 => 61, 71 => 45,
72 => 58, 73 => 87, 74 => 21, 75 => 53, 76 => 62, 77 => 5, 78 => 42,
79 => 80, 80 => 82, 81 => 40, 82 => 100, 83 => 77, 84 => 12, 85 => 14,
86 => 16, 87 => 79, 88 => 6, 89 => 63, 90 => 83, 91 => 2, 92 => 33,
93 => 90, 94 => 93, 95 => 95, 96 => 66, 97 => 96, 98 => 20, 99 => 37,
100 => 57
> dfr_3[["res_order"]]
  [1]  20  37  57  96  72  86  29  51  66   9  40  71  82  50  84  95   6  12
 [19]  14  15  16  60  79  92   1  28  41  55  93  69  26  43  63  10  32  67
 [37]  97   4  13  17  23  30  33  47  49  52  56  81  90  46  65  68  76  78
 [55]  83  94   8  22  24  25  54  64  70  74  75  27  31  88   3  48  77  85
 [73]  91  99 100  18  98  44  59   5   7  19  34  35  39  42  53  62  80  11
 [91]   2  21  36  89  38  45  58  61  73  87
> dfr_4[["res_order"]]
  [1]  20  37  57  96  86  29  51   9  71  15   1  10   4  47  78  72  66  40
 [19]  84  69  26  43  94  82  95   6  79  28  41  55  97  52  56  76  64  50
 [37]  12  14  16  93  63  25  27  98  60  92  33  90  24  48  35  39  32  23
 [55]  83  77  44  59  13  30  81   8  22  70  75 100  80  67  65  68   3  85
 [73]   5  42  53  62   2  17  49  54  31  88  18   7  19  11  21  45  58  61
 [91]  46  74  91  99  34  36  89  38  73  87
> dfr_5[["res_order"]]
  [1]  20  37  57  96  86  29  51   9  71  15   1  10   4  47  78  72  66  40
 [19]  84  69  26  43  94  82  95   6  79  28  41  55  97  52  56  76  64  50
 [37]  12  14  16  93  63  25  27  98  60  92  33  90  24  48  35  39  32  23
 [55]  83  77  44  59  13  30  81   8  22  70  75 100  80  67  65  68   3  85
 [73]   5  42  53  62   2  17  49  54  31  88  18   7  19  11  21  45  58  61
 [91]  46  74  91  99  34  36  89  38  73  87
> dfr_6[["res_order"]]
  [1]  20  37  57  96  86  29  51   9  71  15   1  10   4  47  78  72  66  40
 [19]  84  69  26  43  94  82  95   6  79  28  41  55  97  52  56  76  64  50
 [37]  12  14  16  93  63  25  27  98  60  92  33  90  24  48  35  39  32  23
 [55]  83  77  44  59  13  30  81   8  22  70  75 100  80  67  65  68   3  85
 [73]   5  42  53  62   2  17  49  54  31  88  18   7  19  11  21  45  58  61
 [91]  46  74  91  99  34  36  89  38  73  87
> message('identical(dfr_4[["res_order"]], dfr_5[["res_order"]]) (should be TRUE): ', identical(dfr_4[["res_order"]], dfr_5[["res_order"]]))
identical(dfr_4[["res_order"]], dfr_5[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_4[["res_order"]], dfr_6[["res_order"]]) (should be TRUE): ', identical(dfr_4[["res_order"]], dfr_6[["res_order"]]))
identical(dfr_4[["res_order"]], dfr_6[["res_order"]]) (should be TRUE): TRUE
> 
> 
> # Compare the results above with what should be the identical results with the
> # formula method with "lm" method.
> 
> df <- as.data.frame(cbind(Y, X[,2:3]))
> colnames(df) <- c("y", "b", "c")
> test_form_lm <- y ~ b + c
> Sig <- diag(rexp(n))
> 
> dfr_form_lm_1 <- distfreereg(test_mean = test_form_lm, data = df,
+                              covariance = list(Sigma = Sig),
+                              verbose = TRUE, ordering = "asis")
Converting covariance specification to weights...
Using weights from lm object as covariance specification...
Calculating Jacobian from lm object...
Retrieving fitted values from 'lm' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Leaving observation order as is...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> dfr_form_lm_2 <- distfreereg(test_mean = test_form_lm, data = df,
+                              covariance = list(Sigma = Sig),
+                              verbose = TRUE, ordering = "optimal")
Converting covariance specification to weights...
Using weights from lm object as covariance specification...
Calculating Jacobian from lm object...
Retrieving fitted values from 'lm' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Ordering observations using optimal transport...
- Creating distance matrix...
- Solving linear sum assignment problem using the Hungarian method...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> dfr_form_lm_3 <- distfreereg(test_mean = test_form_lm, data = df,
+                              covariance = list(Sigma = Sig),
+                              verbose = TRUE, ordering = "simplex")
Converting covariance specification to weights...
Using weights from lm object as covariance specification...
Calculating Jacobian from lm object...
Retrieving fitted values from 'lm' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by simplex method...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> dfr_form_lm_4 <- distfreereg(test_mean = test_form_lm, data = df,
+                              covariance = list(Sigma = Sig),
+                              verbose = TRUE, ordering = "natural")
Converting covariance specification to weights...
Using weights from lm object as covariance specification...
Calculating Jacobian from lm object...
Retrieving fitted values from 'lm' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by natural order...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> dfr_form_lm_5 <- distfreereg(test_mean = test_form_lm, data = df,
+                              covariance = list(Sigma = Sig),
+                              verbose = TRUE, ordering = list(1:2))
Converting covariance specification to weights...
Using weights from lm object as covariance specification...
Calculating Jacobian from lm object...
Retrieving fitted values from 'lm' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by specified columns...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> dfr_form_lm_6 <- distfreereg(test_mean = test_form_lm, data = df,
+                              covariance = list(Sigma = Sig),
+                              verbose = TRUE, ordering = list("b", "c"))
Converting covariance specification to weights...
Using weights from lm object as covariance specification...
Calculating Jacobian from lm object...
Retrieving fitted values from 'lm' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by specified columns...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> 
> message('identical(dfr_1[["res_order"]], dfr_form_lm_1[["res_order"]]) (should be TRUE): ', identical(dfr_1[["res_order"]], dfr_form_lm_1[["res_order"]]))
identical(dfr_1[["res_order"]], dfr_form_lm_1[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_2[["res_order"]], dfr_form_lm_2[["res_order"]]) (should be TRUE): ', identical(dfr_2[["res_order"]], dfr_form_lm_2[["res_order"]]))
identical(dfr_2[["res_order"]], dfr_form_lm_2[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_3[["res_order"]], dfr_form_lm_3[["res_order"]]) (should be TRUE): ', identical(dfr_3[["res_order"]], dfr_form_lm_3[["res_order"]]))
identical(dfr_3[["res_order"]], dfr_form_lm_3[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_4[["res_order"]], dfr_form_lm_4[["res_order"]]) (should be TRUE): ', identical(dfr_4[["res_order"]], dfr_form_lm_4[["res_order"]]))
identical(dfr_4[["res_order"]], dfr_form_lm_4[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_5[["res_order"]], dfr_form_lm_5[["res_order"]]) (should be TRUE): ', identical(dfr_5[["res_order"]], dfr_form_lm_5[["res_order"]]))
identical(dfr_5[["res_order"]], dfr_form_lm_5[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_6[["res_order"]], dfr_form_lm_6[["res_order"]]) (should be TRUE): ', identical(dfr_6[["res_order"]], dfr_form_lm_6[["res_order"]]))
identical(dfr_6[["res_order"]], dfr_form_lm_6[["res_order"]]) (should be TRUE): TRUE
> 
> 
> 
> 
> 
> # Compare the results above with what should be the identical results with the
> # formula method with "nls" method.
> 
> test_form_nls <- y ~ u + v*b + w*c
> 
> dfr_form_nls_1 <- distfreereg(test_mean = test_form_nls, data = df,
+                              covariance = list(Sigma = Sig), method = "nls",
+                              verbose = TRUE, ordering = "asis")
Converting covariance specification to weights...
Using weights from nls object as covariance specification...
Retrieving Jacobian from 'nls' object...
Retrieving fitted values from 'nls' object...
Using supplied inverse square root of the covariance matrix...
Calculating mu...
Leaving observation order as is...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
Warning message:
In (function (formula, data = parent.frame(), start, control = nls.control(),  :
  No starting values specified for some parameters.
Initializing 'u', 'v', 'w' to '1.'.
Consider specifying 'start' or using a selfStart model
> dfr_form_nls_2 <- distfreereg(test_mean = test_form_nls, data = df,
+                              covariance = list(Sigma = Sig), method = "nls",
+                              verbose = TRUE, ordering = "optimal")
Converting covariance specification to weights...
Using weights from nls object as covariance specification...
Retrieving Jacobian from 'nls' object...
Retrieving fitted values from 'nls' object...
Using supplied inverse square root of the covariance matrix...
Calculating mu...
Ordering observations using optimal transport...
- Creating distance matrix...
- Solving linear sum assignment problem using the Hungarian method...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
Warning message:
In (function (formula, data = parent.frame(), start, control = nls.control(),  :
  No starting values specified for some parameters.
Initializing 'u', 'v', 'w' to '1.'.
Consider specifying 'start' or using a selfStart model
> dfr_form_nls_3 <- distfreereg(test_mean = test_form_nls, data = df,
+                              covariance = list(Sigma = Sig), method = "nls",
+                              verbose = TRUE, ordering = "simplex")
Converting covariance specification to weights...
Using weights from nls object as covariance specification...
Retrieving Jacobian from 'nls' object...
Retrieving fitted values from 'nls' object...
Using supplied inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by simplex method...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
Warning message:
In (function (formula, data = parent.frame(), start, control = nls.control(),  :
  No starting values specified for some parameters.
Initializing 'u', 'v', 'w' to '1.'.
Consider specifying 'start' or using a selfStart model
> dfr_form_nls_4 <- distfreereg(test_mean = test_form_nls, data = df,
+                              covariance = list(Sigma = Sig), method = "nls",
+                              verbose = TRUE, ordering = "natural")
Converting covariance specification to weights...
Using weights from nls object as covariance specification...
Retrieving Jacobian from 'nls' object...
Retrieving fitted values from 'nls' object...
Using supplied inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by natural order...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
Warning message:
In (function (formula, data = parent.frame(), start, control = nls.control(),  :
  No starting values specified for some parameters.
Initializing 'u', 'v', 'w' to '1.'.
Consider specifying 'start' or using a selfStart model
> dfr_form_nls_5 <- distfreereg(test_mean = test_form_nls, data = df,
+                              covariance = list(Sigma = Sig), method = "nls",
+                              verbose = TRUE, ordering = list(1:2))
Converting covariance specification to weights...
Using weights from nls object as covariance specification...
Retrieving Jacobian from 'nls' object...
Retrieving fitted values from 'nls' object...
Using supplied inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by specified columns...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
Warning message:
In (function (formula, data = parent.frame(), start, control = nls.control(),  :
  No starting values specified for some parameters.
Initializing 'u', 'v', 'w' to '1.'.
Consider specifying 'start' or using a selfStart model
> dfr_form_nls_6 <- distfreereg(test_mean = test_form_nls, data = df,
+                              covariance = list(Sigma = Sig), method = "nls",
+                              verbose = TRUE, ordering = list("b", "c"))
Converting covariance specification to weights...
Using weights from nls object as covariance specification...
Retrieving Jacobian from 'nls' object...
Retrieving fitted values from 'nls' object...
Using supplied inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by specified columns...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
Warning message:
In (function (formula, data = parent.frame(), start, control = nls.control(),  :
  No starting values specified for some parameters.
Initializing 'u', 'v', 'w' to '1.'.
Consider specifying 'start' or using a selfStart model
> 
> message('identical(dfr_1[["res_order"]], dfr_form_nls_1[["res_order"]]) (should be TRUE): ', identical(dfr_1[["res_order"]], dfr_form_nls_1[["res_order"]]))
identical(dfr_1[["res_order"]], dfr_form_nls_1[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_2[["res_order"]], dfr_form_nls_2[["res_order"]]) (should be FALSE): ', identical(dfr_2[["res_order"]], dfr_form_nls_2[["res_order"]]))
identical(dfr_2[["res_order"]], dfr_form_nls_2[["res_order"]]) (should be FALSE): FALSE
> message('identical(dfr_3[["res_order"]], dfr_form_nls_3[["res_order"]]) (should be TRUE): ', identical(dfr_3[["res_order"]], dfr_form_nls_3[["res_order"]]))
identical(dfr_3[["res_order"]], dfr_form_nls_3[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_4[["res_order"]], dfr_form_nls_4[["res_order"]]) (should be TRUE): ', identical(dfr_4[["res_order"]], dfr_form_nls_4[["res_order"]]))
identical(dfr_4[["res_order"]], dfr_form_nls_4[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_5[["res_order"]], dfr_form_nls_5[["res_order"]]) (should be TRUE): ', identical(dfr_5[["res_order"]], dfr_form_nls_5[["res_order"]]))
identical(dfr_5[["res_order"]], dfr_form_nls_5[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_6[["res_order"]], dfr_form_nls_6[["res_order"]]) (should be TRUE): ', identical(dfr_6[["res_order"]], dfr_form_nls_6[["res_order"]]))
identical(dfr_6[["res_order"]], dfr_form_nls_6[["res_order"]]) (should be TRUE): TRUE
> 
> 
> 
> 
> 
> 
> # Now verify distfreereg.lm
> 
> test_lm <- lm(test_form_lm, data = df)
> 
> dfr_lm_1 <- distfreereg(test_mean = test_lm,
+                         verbose = TRUE, ordering = "asis")
'x' and/or 'y' not found in lm object, or 'na.action' must be reset; refitting linear model...
Using residual standard deviation from lm object as covariance specification...
Calculating Jacobian from lm object...
Retrieving fitted values from 'lm' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Leaving observation order as is...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> dfr_lm_2 <- distfreereg(test_mean = test_lm,
+                         verbose = TRUE, ordering = "optimal")
'x' and/or 'y' not found in lm object, or 'na.action' must be reset; refitting linear model...
Using residual standard deviation from lm object as covariance specification...
Calculating Jacobian from lm object...
Retrieving fitted values from 'lm' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Ordering observations using optimal transport...
- Creating distance matrix...
- Solving linear sum assignment problem using the Hungarian method...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> dfr_lm_3 <- distfreereg(test_mean = test_lm,
+                         verbose = TRUE, ordering = "simplex")
'x' and/or 'y' not found in lm object, or 'na.action' must be reset; refitting linear model...
Using residual standard deviation from lm object as covariance specification...
Calculating Jacobian from lm object...
Retrieving fitted values from 'lm' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by simplex method...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> dfr_lm_4 <- distfreereg(test_mean = test_lm,
+                         verbose = TRUE, ordering = "natural")
'x' and/or 'y' not found in lm object, or 'na.action' must be reset; refitting linear model...
Using residual standard deviation from lm object as covariance specification...
Calculating Jacobian from lm object...
Retrieving fitted values from 'lm' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by natural order...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> dfr_lm_5 <- distfreereg(test_mean = test_lm,
+                         verbose = TRUE, ordering = list(1:2))
'x' and/or 'y' not found in lm object, or 'na.action' must be reset; refitting linear model...
Using residual standard deviation from lm object as covariance specification...
Calculating Jacobian from lm object...
Retrieving fitted values from 'lm' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by specified columns...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> dfr_lm_6 <- distfreereg(test_mean = test_lm,
+                         verbose = TRUE, ordering = list("b", "c"))
'x' and/or 'y' not found in lm object, or 'na.action' must be reset; refitting linear model...
Using residual standard deviation from lm object as covariance specification...
Calculating Jacobian from lm object...
Retrieving fitted values from 'lm' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by specified columns...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> 
> message('identical(dfr_1[["res_order"]], dfr_lm_1[["res_order"]]) (should be TRUE): ', identical(dfr_1[["res_order"]], dfr_lm_1[["res_order"]]))
identical(dfr_1[["res_order"]], dfr_lm_1[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_2[["res_order"]], dfr_lm_2[["res_order"]]) (should be TRUE): ', identical(dfr_2[["res_order"]], dfr_lm_2[["res_order"]]))
identical(dfr_2[["res_order"]], dfr_lm_2[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_3[["res_order"]], dfr_lm_3[["res_order"]]) (should be TRUE): ', identical(dfr_3[["res_order"]], dfr_lm_3[["res_order"]]))
identical(dfr_3[["res_order"]], dfr_lm_3[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_4[["res_order"]], dfr_lm_4[["res_order"]]) (should be TRUE): ', identical(dfr_4[["res_order"]], dfr_lm_4[["res_order"]]))
identical(dfr_4[["res_order"]], dfr_lm_4[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_5[["res_order"]], dfr_lm_5[["res_order"]]) (should be TRUE): ', identical(dfr_5[["res_order"]], dfr_lm_5[["res_order"]]))
identical(dfr_5[["res_order"]], dfr_lm_5[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_6[["res_order"]], dfr_lm_6[["res_order"]]) (should be TRUE): ', identical(dfr_6[["res_order"]], dfr_lm_6[["res_order"]]))
identical(dfr_6[["res_order"]], dfr_lm_6[["res_order"]]) (should be TRUE): TRUE
> 
> 
> 
> 
> 
> 
> 
> # Now verify distfreereg.nls
> 
> test_nls <- nls(test_form_nls, data = df)
Warning message:
In nls(test_form_nls, data = df) :
  No starting values specified for some parameters.
Initializing 'u', 'v', 'w' to '1.'.
Consider specifying 'start' or using a selfStart model
> 
> dfr_nls_1 <- distfreereg(test_mean = test_nls,
+                         verbose = TRUE, ordering = "asis")
Using residual standard deviation from nls object as covariance specification...
Retrieving Jacobian from 'nls' object...
Retrieving fitted values from 'nls' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Leaving observation order as is...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> dfr_nls_2 <- distfreereg(test_mean = test_nls,
+                         verbose = TRUE, ordering = "optimal")
Using residual standard deviation from nls object as covariance specification...
Retrieving Jacobian from 'nls' object...
Retrieving fitted values from 'nls' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Ordering observations using optimal transport...
- Creating distance matrix...
- Solving linear sum assignment problem using the Hungarian method...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> dfr_nls_3 <- distfreereg(test_mean = test_nls,
+                         verbose = TRUE, ordering = "simplex")
Using residual standard deviation from nls object as covariance specification...
Retrieving Jacobian from 'nls' object...
Retrieving fitted values from 'nls' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by simplex method...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> dfr_nls_4 <- distfreereg(test_mean = test_nls,
+                         verbose = TRUE, ordering = "natural")
Using residual standard deviation from nls object as covariance specification...
Retrieving Jacobian from 'nls' object...
Retrieving fitted values from 'nls' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by natural order...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> dfr_nls_5 <- distfreereg(test_mean = test_nls,
+                         verbose = TRUE, ordering = list(1:2))
Using residual standard deviation from nls object as covariance specification...
Retrieving Jacobian from 'nls' object...
Retrieving fitted values from 'nls' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by specified columns...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> dfr_nls_6 <- distfreereg(test_mean = test_nls,
+                         verbose = TRUE, ordering = list("b", "c"))
Using residual standard deviation from nls object as covariance specification...
Retrieving Jacobian from 'nls' object...
Retrieving fitted values from 'nls' object...
Calculating the inverse square root of the covariance matrix...
Calculating mu...
Ordering observations by specified columns...
Calculating transformation anchors...
Calculating residuals...
Calculating observed statistic(s)...
Running Monte Carlo simulation...
...1000 of 10000
...2000 of 10000
...3000 of 10000
...4000 of 10000
...5000 of 10000
...6000 of 10000
...7000 of 10000
...8000 of 10000
...9000 of 10000
...10000 of 10000
> 
> message('identical(dfr_1[["res_order"]], dfr_nls_1[["res_order"]]) (should be TRUE): ', identical(dfr_1[["res_order"]], dfr_nls_1[["res_order"]]))
identical(dfr_1[["res_order"]], dfr_nls_1[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_2[["res_order"]], dfr_nls_2[["res_order"]]) (should be FALSE): ', identical(dfr_2[["res_order"]], dfr_nls_2[["res_order"]]))
identical(dfr_2[["res_order"]], dfr_nls_2[["res_order"]]) (should be FALSE): FALSE
> message('identical(dfr_3[["res_order"]], dfr_nls_3[["res_order"]]) (should be TRUE): ', identical(dfr_3[["res_order"]], dfr_nls_3[["res_order"]]))
identical(dfr_3[["res_order"]], dfr_nls_3[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_4[["res_order"]], dfr_nls_4[["res_order"]]) (should be TRUE): ', identical(dfr_4[["res_order"]], dfr_nls_4[["res_order"]]))
identical(dfr_4[["res_order"]], dfr_nls_4[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_5[["res_order"]], dfr_nls_5[["res_order"]]) (should be TRUE): ', identical(dfr_5[["res_order"]], dfr_nls_5[["res_order"]]))
identical(dfr_5[["res_order"]], dfr_nls_5[["res_order"]]) (should be TRUE): TRUE
> message('identical(dfr_6[["res_order"]], dfr_nls_6[["res_order"]]) (should be TRUE): ', identical(dfr_6[["res_order"]], dfr_nls_6[["res_order"]]))
identical(dfr_6[["res_order"]], dfr_nls_6[["res_order"]]) (should be TRUE): TRUE
> 
> proc.time()
   user  system elapsed 
  12.67    0.25   13.20 
