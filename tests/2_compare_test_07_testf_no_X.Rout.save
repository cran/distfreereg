
R version 4.4.2 (2024-10-31 ucrt) -- "Pile of Leaves"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(distfreereg)
> set.seed(20240123)
> 
> # Test case where only true_mean contains X argument
> 
> n <- 20
> true_mean_func <- function(x, theta) theta[1] + theta[2]*x[1]
> test_mean_func <- function(theta) theta
> theta <- c(2,5)
> X <- rexp(n, rate = 1)
> 
> comp_dfr <- compare(reps = 10, B = 10, theta = theta, true_X = X, X = NULL, true_covariance = list(Sigma = 1),
+                     covariance = list(Sigma = 1),
+                     true_mean = true_mean_func, test_mean = test_mean_func, theta_init = 1)
Calculating required true covariance specification matrices...
Generating errors...
Running simulation...
Repetition 1 of 10
Repetition 2 of 10
Repetition 3 of 10
Repetition 4 of 10
Repetition 5 of 10
Repetition 6 of 10
Repetition 7 of 10
Repetition 8 of 10
Repetition 9 of 10
Repetition 10 of 10
> 
> comp_dfr
$call
compare(true_mean = true_mean_func, true_covariance = list(Sigma = 1), 
    true_X = X, theta = theta, reps = 10, B = 10, X = NULL, covariance = list(Sigma = 1), 
    test_mean = test_mean_func, theta_init = 1)

$Y_mean
 [1]  4.509744  4.875622 11.497283  3.759537  9.966175  4.730762  5.505367
 [8]  3.679032  5.158003  5.149054  9.459365  9.335816 10.680349  2.425573
[15]  3.349120  6.506164  3.766645  6.542342  3.951597  3.570595

$errors
             [,1]       [,2]        [,3]        [,4]       [,5]       [,6]
 [1,] -1.24627555  0.4365054  0.63584991  0.45914204  0.9510704 -0.8102815
 [2,] -0.80522755 -0.7872804  1.46102749  1.51502728  0.7749931  0.5520122
 [3,]  0.01038360 -1.0152053 -1.55610012  0.76223908  0.4819479  2.0521225
 [4,] -0.88597333 -0.2846832 -0.07786907  1.55760160 -1.4871924  0.6080224
 [5,] -0.05355507  1.3391712 -1.30790170  0.48625032  1.3816280  1.4792297
 [6,]  0.04216954  0.0870422  1.60080370 -0.09274921 -0.6669802  1.3070828
 [7,]  1.80995969  0.6447946  0.17477369  0.21620961  1.5286765  0.8774530
 [8,] -0.39075328  0.7220009  0.14239089  0.11404996 -1.8350307 -0.1219861
 [9,] -0.19575533  1.1252121 -0.83970419 -0.68653836  1.3474914  0.8383293
[10,] -0.61517842  1.5603116  0.18739688 -0.24696143  0.7819719 -0.2410527
[11,] -0.50554856  2.3135654  0.52181415  1.76827033  1.1261828  0.5341186
[12,] -0.39588331  2.1460322  1.19553817 -0.10535063  1.0929094 -1.5564509
[13,]  0.05809460  1.2422099  0.99761131  0.11686021  1.6404125  0.7176601
[14,] -0.94415048 -0.4908044  0.93132182  0.24656271 -0.2856162 -1.0285365
[15,] -2.01615883  1.0360677 -0.23292403 -0.21858508  1.1650582 -1.0853533
[16,]  0.37144407  0.7628817  0.87238979 -0.40641534  0.7674998  0.7556938
[17,]  0.77226698  0.5883750  0.06433393 -0.98089936 -0.8606370  0.7982211
[18,]  1.88318204 -0.7594999 -0.69141873  0.68041260  0.7544615 -1.1707089
[19,]  0.36858304  2.0572631  0.34160191 -0.24496475  1.0297236  0.6062817
[20,] -0.84575137  0.7077227  2.33807398 -0.51590709 -0.9415940  0.6845709
             [,7]        [,8]          [,9]       [,10]
 [1,] -0.06574344  1.27393191 -3.0311095185 -1.14161171
 [2,]  0.05776228 -0.09332015  0.4494772595 -0.72719770
 [3,]  0.88540794 -0.97196442  1.5179098122  0.39817497
 [4,]  0.13350337 -0.06611611  0.9082382296  1.51864130
 [5,]  0.43121728 -1.89789955 -2.4343285776  0.63087059
 [6,] -0.60887871 -2.92009698  0.5904821585 -0.07005174
 [7,] -0.08052875  0.70690094  0.9971054127  0.43855167
 [8,] -1.10745254  0.04835663 -0.6611695388 -1.31790273
 [9,]  1.77597904 -1.43589452 -0.7625225075  0.57275301
[10,]  0.67438213  0.12327743 -1.7147349164  0.46650648
[11,]  0.43156209 -1.06297415 -0.9572803132 -1.66543715
[12,]  1.04764245 -0.69701618  1.0093357756  0.71047463
[13,]  0.10220670  1.23728272 -0.7271130954 -0.07337796
[14,]  0.10256843  1.13567649 -0.7893049201 -1.85867862
[15,] -0.11256292  0.29364184 -0.0016270282 -0.43624019
[16,] -0.82311025 -1.75967412 -1.3510016261 -0.69953716
[17,]  1.40514072 -0.67803316  0.5944555019 -0.92122456
[18,]  0.46229505 -0.82658694  1.6776247284  0.13994022
[19,]  1.81444849  0.74587813 -1.0125894947  0.93524030
[20,] -0.53543483  0.14643225  0.0005613089  1.58140713

$theta
[1] 2 5

$true_mean
function (x, theta) 
theta[1] + theta[2] * x[1]
<bytecode: 0x000001ecfc29b920>

$true_covariance
$true_covariance$Sigma
[1] 1

$true_covariance$SqrtSigma
[1] 1


$true_X
            [,1]
 [1,] 0.50194882
 [2,] 0.57512431
 [3,] 1.89945655
 [4,] 0.35190743
 [5,] 1.59323504
 [6,] 0.54615239
 [7,] 0.70107333
 [8,] 0.33580643
 [9,] 0.63160066
[10,] 0.62981070
[11,] 1.49187297
[12,] 1.46716323
[13,] 1.73606986
[14,] 0.08511453
[15,] 0.26982403
[16,] 0.90123282
[17,] 0.35332891
[18,] 0.90846836
[19,] 0.39031934
[20,] 0.31411909

$true_data
NULL

$test_mean
function (theta) 
theta

$covariance
$covariance$Sigma
[1] 1

$covariance$P
[1] 1

$covariance$Q
[1] 1


$X
NULL

$data
NULL

$observed_stats
         KS       CvM
1  2.345737 0.7065342
2  2.713110 1.0234683
3  2.253194 0.6837051
4  3.202631 2.2287195
5  2.854757 1.2913704
6  3.086421 1.8761219
7  2.485974 0.8961704
8  2.220999 0.7926668
9  2.285718 0.8517843
10 2.697115 1.0180195

$mcsim_stats
$mcsim_stats$KS
 [1] 0.7490667 1.6066509 0.6846470 0.4687357 0.7891645 0.5843458 0.6513542
 [8] 0.7397144 0.6759506 0.6853299

$mcsim_stats$CvM
 [1] 0.08183486 0.65091358 0.11188323 0.06692026 0.19114268 0.05107640
 [7] 0.09175233 0.14295994 0.14689095 0.07925643


$p
   KS CvM
1   0   0
2   0   0
3   0   0
4   0   0
5   0   0
6   0   0
7   0   0
8   0   0
9   0   0
10  0   0

attr(,"class")
[1] "compare"
> 
> proc.time()
   user  system elapsed 
   0.17    0.10    0.28 
