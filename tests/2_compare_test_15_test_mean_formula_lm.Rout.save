
R version 4.4.1 (2024-06-14 ucrt) -- "Race for Your Life"
Copyright (C) 2024 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(distfreereg)
> set.seed(20240305)
> n <- 20
> Sig <- diag(rexp(n))
> theta <- c(2,5)
> func <- function(x, theta) sum(theta * x)
> 
> # test formula
> data <- data.frame(a = rexp(n, rate = 1),
+                    b = rnorm(n))
> data$c <- 4*data$a - 3*data$b
> 
> set.seed(20240305)
> cdfr_1 <- compare(true_mean = func, true_covariance = list(Sigma = Sig),
+                   covariance = list(Sigma = Sig),
+                   true_X = as.matrix(data[,-3]), test_mean = c ~ a + b - 1,
+                   data = data, reps = 10, B = 10, prog = Inf, theta = theta)
Calculating required true covariance specification matrices...
Generating errors...
Running simulation...
> cdfr_1
$call
compare(true_mean = func, true_covariance = list(Sigma = Sig), 
    true_X = as.matrix(data[, -3]), theta = theta, reps = 10, 
    prog = Inf, covariance = list(Sigma = Sig), test_mean = c ~ 
        a + b - 1, data = data, B = 10)

$Y_mean
 [1] -2.4273229  0.8947819  3.1309358 -8.8347440  4.0233119  7.5777454
 [7]  1.4951023 -3.3856032  6.4294998  0.8554240 -2.2441614  0.2246008
[13]  2.5304190 -7.6598887 -1.7421165  8.2870268 -4.5721537  2.5264889
[19]  8.4689232  6.4578725

$errors
             [,1]       [,2]        [,3]        [,4]        [,5]        [,6]
 [1,] -0.08988969 -0.5197995  0.29918734 -0.43049049  1.01491247  0.77323587
 [2,] -0.36186875 -0.4650966  0.23036150  0.64212473  0.29148519 -0.51736855
 [3,]  0.32534500  0.9545166 -0.59502182  0.47381212  1.53393971  0.20444381
 [4,] -0.10275188  0.4959162 -0.07939344  0.16913715 -0.03103919  0.03935769
 [5,] -2.19692501 -1.6068502 -1.43106893 -1.82558652  1.04000662  0.15788111
 [6,] -2.02289918  1.1182828 -1.76871931  1.24888550 -1.37388356  2.45909785
 [7,] -0.46459408  0.6196528  0.04331005 -0.27433854  0.61194667  0.62966378
 [8,]  0.46871530 -0.4588259 -0.08265711  0.13377689  0.06685964 -0.35885234
 [9,]  0.15667835  1.1017052  0.30077845  0.42360443  0.83448295  0.56996448
[10,]  0.57977594 -0.0138692  0.60399765  0.54830399 -0.01427432 -1.14140641
[11,]  0.45004797  0.2131784 -0.14084282 -0.43273332  0.14405672 -0.31291911
[12,]  0.55113947 -0.4003899 -0.14476256  0.16885829  0.19574043  0.53386108
[13,] -1.52332626  2.5888331 -0.14739265 -1.06908203  0.17779136  1.18900488
[14,] -0.22657191 -0.8769592  1.22081361  1.04855492  0.58524678 -0.74731474
[15,]  1.67662814 -1.1105128  0.74923392 -1.01326457 -0.63651373 -0.13588600
[16,]  1.63156022 -0.6109770  0.19722787 -1.16266802 -0.38778255  0.17406207
[17,] -0.90434773  1.8495966 -1.53814722 -0.39326744  0.48125455  0.06478799
[18,]  0.78521543 -0.1893763  0.43177943  0.99181641  0.22232389 -0.37746967
[19,] -0.47605869 -1.1028237 -0.23342052  0.07455687 -0.84823418  2.12917798
[20,] -0.33253524 -0.3474936 -0.41734479  0.24270545 -0.18515619  0.58030642
             [,7]         [,8]          [,9]       [,10]
 [1,] -1.47753550  0.990495627 -0.2901030587  0.00569600
 [2,] -0.35719242 -0.564544980  0.1899331062 -0.23459526
 [3,]  0.53918041  0.498171678  0.5234866358  1.29959579
 [4,]  0.07089662 -0.294917648  0.0003294291 -0.16585250
 [5,] -0.04540409 -1.873197547 -0.8541570750 -0.74229267
 [6,]  0.47647594  0.161702474  0.1940334464 -0.60230440
 [7,]  0.08301724  1.397774352  0.3138116006 -0.03776676
 [8,]  0.29733545 -0.062335551  0.2326631875  0.47344366
 [9,] -1.23002676 -1.278898668  0.0356280618  0.51243413
[10,] -0.52348748 -0.425958853  0.3669233418  0.23360221
[11,]  0.12108636  0.001960891  0.2493802489  0.27776284
[12,]  0.27145811  0.312001351  0.0177070992 -0.58147555
[13,] -0.65310239 -1.983986280  0.4424103713 -0.78265778
[14,] -1.42421965  0.812767071  1.2170469034 -1.52841082
[15,]  0.26281311 -1.039884339  1.1100516469  0.08602568
[16,] -0.28111256  0.806022214 -1.1117735554  1.48010870
[17,] -1.25939100  0.257142704  0.6243027957  0.27742654
[18,] -0.15246756 -0.639236730  0.2246050926  0.33625253
[19,]  0.03566374  0.609458646 -0.1396603528 -0.90979199
[20,]  0.82044098  0.447938733  0.6563081485  1.24571816

$theta
[1] 2 5

$true_mean
function (x, theta) 
sum(theta * x)
<bytecode: 0x000001eca8d9e378>

$true_covariance
$true_covariance$Sigma
           [,1]      [,2]     [,3]       [,4]     [,5]     [,6]      [,7]
 [1,] 0.8952175 0.0000000 0.000000 0.00000000 0.000000 0.000000 0.0000000
 [2,] 0.0000000 0.4345745 0.000000 0.00000000 0.000000 0.000000 0.0000000
 [3,] 0.0000000 0.0000000 1.009512 0.00000000 0.000000 0.000000 0.0000000
 [4,] 0.0000000 0.0000000 0.000000 0.05393898 0.000000 0.000000 0.0000000
 [5,] 0.0000000 0.0000000 0.000000 0.00000000 2.156886 0.000000 0.0000000
 [6,] 0.0000000 0.0000000 0.000000 0.00000000 0.000000 2.137123 0.0000000
 [7,] 0.0000000 0.0000000 0.000000 0.00000000 0.000000 0.000000 0.5053631
 [8,] 0.0000000 0.0000000 0.000000 0.00000000 0.000000 0.000000 0.0000000
 [9,] 0.0000000 0.0000000 0.000000 0.00000000 0.000000 0.000000 0.0000000
[10,] 0.0000000 0.0000000 0.000000 0.00000000 0.000000 0.000000 0.0000000
[11,] 0.0000000 0.0000000 0.000000 0.00000000 0.000000 0.000000 0.0000000
[12,] 0.0000000 0.0000000 0.000000 0.00000000 0.000000 0.000000 0.0000000
[13,] 0.0000000 0.0000000 0.000000 0.00000000 0.000000 0.000000 0.0000000
[14,] 0.0000000 0.0000000 0.000000 0.00000000 0.000000 0.000000 0.0000000
[15,] 0.0000000 0.0000000 0.000000 0.00000000 0.000000 0.000000 0.0000000
[16,] 0.0000000 0.0000000 0.000000 0.00000000 0.000000 0.000000 0.0000000
[17,] 0.0000000 0.0000000 0.000000 0.00000000 0.000000 0.000000 0.0000000
[18,] 0.0000000 0.0000000 0.000000 0.00000000 0.000000 0.000000 0.0000000
[19,] 0.0000000 0.0000000 0.000000 0.00000000 0.000000 0.000000 0.0000000
[20,] 0.0000000 0.0000000 0.000000 0.00000000 0.000000 0.000000 0.0000000
           [,8]      [,9]     [,10]      [,11]     [,12]    [,13]     [,14]
 [1,] 0.0000000 0.0000000 0.0000000 0.00000000 0.0000000 0.000000 0.0000000
 [2,] 0.0000000 0.0000000 0.0000000 0.00000000 0.0000000 0.000000 0.0000000
 [3,] 0.0000000 0.0000000 0.0000000 0.00000000 0.0000000 0.000000 0.0000000
 [4,] 0.0000000 0.0000000 0.0000000 0.00000000 0.0000000 0.000000 0.0000000
 [5,] 0.0000000 0.0000000 0.0000000 0.00000000 0.0000000 0.000000 0.0000000
 [6,] 0.0000000 0.0000000 0.0000000 0.00000000 0.0000000 0.000000 0.0000000
 [7,] 0.0000000 0.0000000 0.0000000 0.00000000 0.0000000 0.000000 0.0000000
 [8,] 0.1642019 0.0000000 0.0000000 0.00000000 0.0000000 0.000000 0.0000000
 [9,] 0.0000000 0.5713996 0.0000000 0.00000000 0.0000000 0.000000 0.0000000
[10,] 0.0000000 0.0000000 0.3869043 0.00000000 0.0000000 0.000000 0.0000000
[11,] 0.0000000 0.0000000 0.0000000 0.09318216 0.0000000 0.000000 0.0000000
[12,] 0.0000000 0.0000000 0.0000000 0.00000000 0.2514432 0.000000 0.0000000
[13,] 0.0000000 0.0000000 0.0000000 0.00000000 0.0000000 1.898149 0.0000000
[14,] 0.0000000 0.0000000 0.0000000 0.00000000 0.0000000 0.000000 0.6646319
[15,] 0.0000000 0.0000000 0.0000000 0.00000000 0.0000000 0.000000 0.0000000
[16,] 0.0000000 0.0000000 0.0000000 0.00000000 0.0000000 0.000000 0.0000000
[17,] 0.0000000 0.0000000 0.0000000 0.00000000 0.0000000 0.000000 0.0000000
[18,] 0.0000000 0.0000000 0.0000000 0.00000000 0.0000000 0.000000 0.0000000
[19,] 0.0000000 0.0000000 0.0000000 0.00000000 0.0000000 0.000000 0.0000000
[20,] 0.0000000 0.0000000 0.0000000 0.00000000 0.0000000 0.000000 0.0000000
         [,15]     [,16]    [,17]     [,18]    [,19]    [,20]
 [1,] 0.000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
 [2,] 0.000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
 [3,] 0.000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
 [4,] 0.000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
 [5,] 0.000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
 [6,] 0.000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
 [7,] 0.000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
 [8,] 0.000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
 [9,] 0.000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
[10,] 0.000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
[11,] 0.000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
[12,] 0.000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
[13,] 0.000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
[14,] 0.000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
[15,] 0.599578 0.0000000 0.000000 0.0000000 0.000000 0.000000
[16,] 0.000000 0.5470252 0.000000 0.0000000 0.000000 0.000000
[17,] 0.000000 0.0000000 1.052141 0.0000000 0.000000 0.000000
[18,] 0.000000 0.0000000 0.000000 0.8720114 0.000000 0.000000
[19,] 0.000000 0.0000000 0.000000 0.0000000 1.327719 0.000000
[20,] 0.000000 0.0000000 0.000000 0.0000000 0.000000 2.071625

$true_covariance$SqrtSigma
           [,1]      [,2]     [,3]      [,4]     [,5]    [,6]      [,7]
 [1,] 0.9461594 0.0000000 0.000000 0.0000000 0.000000 0.00000 0.0000000
 [2,] 0.0000000 0.6592227 0.000000 0.0000000 0.000000 0.00000 0.0000000
 [3,] 0.0000000 0.0000000 1.004745 0.0000000 0.000000 0.00000 0.0000000
 [4,] 0.0000000 0.0000000 0.000000 0.2322477 0.000000 0.00000 0.0000000
 [5,] 0.0000000 0.0000000 0.000000 0.0000000 1.468634 0.00000 0.0000000
 [6,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 1.46189 0.0000000
 [7,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.00000 0.7108889
 [8,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.00000 0.0000000
 [9,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.00000 0.0000000
[10,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.00000 0.0000000
[11,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.00000 0.0000000
[12,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.00000 0.0000000
[13,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.00000 0.0000000
[14,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.00000 0.0000000
[15,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.00000 0.0000000
[16,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.00000 0.0000000
[17,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.00000 0.0000000
[18,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.00000 0.0000000
[19,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.00000 0.0000000
[20,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.00000 0.0000000
           [,8]      [,9]     [,10]     [,11]     [,12]    [,13]     [,14]
 [1,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.000000 0.0000000
 [2,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.000000 0.0000000
 [3,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.000000 0.0000000
 [4,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.000000 0.0000000
 [5,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.000000 0.0000000
 [6,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.000000 0.0000000
 [7,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.000000 0.0000000
 [8,] 0.4052184 0.0000000 0.0000000 0.0000000 0.0000000 0.000000 0.0000000
 [9,] 0.0000000 0.7559098 0.0000000 0.0000000 0.0000000 0.000000 0.0000000
[10,] 0.0000000 0.0000000 0.6220163 0.0000000 0.0000000 0.000000 0.0000000
[11,] 0.0000000 0.0000000 0.0000000 0.3052575 0.0000000 0.000000 0.0000000
[12,] 0.0000000 0.0000000 0.0000000 0.0000000 0.5014411 0.000000 0.0000000
[13,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 1.377733 0.0000000
[14,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.000000 0.8152496
[15,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.000000 0.0000000
[16,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.000000 0.0000000
[17,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.000000 0.0000000
[18,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.000000 0.0000000
[19,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.000000 0.0000000
[20,] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.000000 0.0000000
          [,15]     [,16]    [,17]     [,18]    [,19]    [,20]
 [1,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
 [2,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
 [3,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
 [4,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
 [5,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
 [6,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
 [7,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
 [8,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
 [9,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
[10,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
[11,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
[12,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
[13,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
[14,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 0.000000
[15,] 0.7743242 0.0000000 0.000000 0.0000000 0.000000 0.000000
[16,] 0.0000000 0.7396115 0.000000 0.0000000 0.000000 0.000000
[17,] 0.0000000 0.0000000 1.025739 0.0000000 0.000000 0.000000
[18,] 0.0000000 0.0000000 0.000000 0.9338155 0.000000 0.000000
[19,] 0.0000000 0.0000000 0.000000 0.0000000 1.152267 0.000000
[20,] 0.0000000 0.0000000 0.000000 0.0000000 0.000000 1.439314


$true_X
               a           b
 [1,] 0.85863874 -0.82892008
 [2,] 2.63450018 -0.87484370
 [3,] 1.96087604 -0.15816325
 [4,] 0.14317048 -1.82421698
 [5,] 0.09492852  0.76669098
 [6,] 0.55570271  1.29326799
 [7,] 0.04994627  0.27904195
 [8,] 0.61660563 -0.92376289
 [9,] 0.28753258  1.17088693
[10,] 1.41633968 -0.39545107
[11,] 0.03413202 -0.46248510
[12,] 0.34040836 -0.09124319
[13,] 0.55498306  0.28409057
[14,] 0.51504543 -1.73799591
[15,] 1.16264496 -0.81348128
[16,] 1.66393582  0.99183104
[17,] 0.31757481 -1.04146066
[18,] 1.51455071 -0.10052249
[19,] 0.52521322  1.48369934
[20,] 2.29163100  0.37492210

$true_data
NULL

$test_mean
c ~ a + b - 1

$covariance
$covariance$P
 [1]  1.1170469  2.3011013  0.9905773 18.5394679  0.4636314  0.4679188
 [7]  1.9787753  6.0900617  1.7500888  2.5846188 10.7316681  3.9770415
[13]  0.5268291  1.5045922  1.6678397  1.8280695  0.9504429  1.1467740
[19]  0.7531715  0.4827129

$covariance$Q
 [1] 1.0569044 1.5169381 0.9952775 4.3057482 0.6809049 0.6840459 1.4066895
 [8] 2.4678050 1.3229092 1.6076750 3.2759225 1.9942521 0.7258299 1.2266182
[15] 1.2914487 1.3520612 0.9749066 1.0708753 0.8678546 0.6947754


$X
NULL

$data
            a           b          c
1  0.85863874 -0.82892008  5.9213152
2  2.63450018 -0.87484370 13.1625318
3  1.96087604 -0.15816325  8.3179939
4  0.14317048 -1.82421698  6.0453329
5  0.09492852  0.76669098 -1.9203588
6  0.55570271  1.29326799 -1.6569932
7  0.04994627  0.27904195 -0.6373408
8  0.61660563 -0.92376289  5.2377112
9  0.28753258  1.17088693 -2.3625305
10 1.41633968 -0.39545107  6.8517119
11 0.03413202 -0.46248510  1.5239834
12 0.34040836 -0.09124319  1.6353630
13 0.55498306  0.28409057  1.3676605
14 0.51504543 -1.73799591  7.2741694
15 1.16264496 -0.81348128  7.0910237
16 1.66393582  0.99183104  3.6802501
17 0.31757481 -1.04146066  4.3946812
18 1.51455071 -0.10052249  6.3597703
19 0.52521322  1.48369934 -2.3502451
20 2.29163100  0.37492210  8.0417577

$observed_stats
          KS        CvM
1  0.5934746 0.06452654
2  0.7018306 0.06860809
3  0.3899667 0.04726839
4  0.8817819 0.13520264
5  0.5430769 0.08908930
6  0.3683632 0.03618414
7  0.6881859 0.17439902
8  0.8481671 0.10431223
9  0.5189520 0.11057172
10 0.4359645 0.05769803

$mcsim_stats
$mcsim_stats$KS
 [1] 0.6566618 0.8718749 0.4488316 0.5202599 0.4970432 0.4829389 0.6508980
 [8] 0.5994264 0.7854798 0.6658661

$mcsim_stats$CvM
 [1] 0.07963389 0.36253676 0.04979264 0.03991951 0.05458826 0.07885608
 [7] 0.11140207 0.06660548 0.07846129 0.08895484


$p
    KS CvM
1  0.6 0.7
2  0.2 0.6
3  1.0 0.9
4  0.0 0.1
5  0.6 0.2
6  1.0 1.0
7  0.2 0.1
8  0.1 0.2
9  0.7 0.2
10 1.0 0.7

attr(,"class")
[1] "compare"
> 
> 
> 
> # test lm
> m <- lm(c ~ a + b - 1, data = data, weights = 1/diag(Sig))
> 
> set.seed(20240305)
> cdfr_2 <- compare(true_mean = func, true_covariance = list(Sigma = Sig),
+                   true_X = as.matrix(data[,-3]), test_mean = m,
+                   reps = 10, B = 10, prog = Inf, theta = theta)
Calculating required true covariance specification matrices...
Generating errors...
Running simulation...
> 
> identical(cdfr_1[["observed_stats"]], cdfr_2[["observed_stats"]])# TRUE
[1] TRUE
> identical(cdfr_1[["mcsim_stats"]], cdfr_2[["mcsim_stats"]])# TRUE
[1] TRUE
> identical(cdfr_1[["p"]], cdfr_2[["p"]])# TRUE
[1] TRUE
> 
> proc.time()
   user  system elapsed 
   0.37    0.14    0.48 
